import pandas as pd


# Load with proper encoding and delimiter
df = pd.read_csv("time-series/payroll/Lohnkonto2022-2025.csv", encoding="ISO-8859-1", sep=";")

# Translate headers
translation_dict = {
    "Firma": "Company",
    "Persnr.": "Personnel No.",
    "ID": "ID",
    "Name": "Name",
    "Geschlecht": "Gender",
    "Lohnart": "Payroll Type",
    "Beschreibung": "Description",
    "E/B": "Earnings/Deductions",
    "Jänner_2022": "January_2022",
    "Februar_2022": "February_2022",
    "März_2022": "March_2022",
    "April_2022": "April_2022",
    "Mai_2022": "May_2022",
    "Juni_2022": "June_2022",
    "Juli_2022": "July_2022",
    "August_2022": "August_2022",
    "Sept._2022": "September_2022",
    "Oktober_2022": "October_2022",
    "Nov._2022": "November_2022",
    "Dez._2022": "December_2022",
    "Jänner_2023": "January_2023",
    "Februar_2023": "February_2023",
    "März_2023": "March_2023",
    "April_2023": "April_2023",
    "Mai_2023": "May_2023",
    "Juni_2023": "June_2023",
    "Juli_2023": "July_2023",
    "August_2023": "August_2023",
    "Sept._2023": "September_2023",
    "Oktober_2023": "October_2023",
    "Nov._2023": "November_2023",
    "Dez._2023": "December_2023",
    "Jänner_2024": "January_2024",
    "Februar_2024": "February_2024",
    "März_2024": "March_2024",
    "April_2024": "April_2024",
    "Mai_2024": "May_2024",
    "Juni_2024": "June_2024",
    "Juli_2024": "July_2024",
    "August_2024": "August_2024",
    "Sept._2024": "September_2024",
    "Oktober_2024": "October_2024",
    "Nov._2024": "November_2024",
    "Dez._2024": "December_2024",
    "Jänner_2025": "January_2025",
    "Februar_2025": "February_2025",
    "März_2025": "March_2025",
    "April_2025": "April_2025",
    "Mai_2025": "May_2025",
    "Juni_2025": "June_2025",
    "Gesamtsumme": "Total Amount",
}
df.rename(columns=translation_dict, inplace=True)

# Example: translate payroll item names (optional)
# payroll_translation = {
#     'Gehalt': 'Salary',
#     'Bonus': 'Bonus',
#     'Steuern': 'Taxes',
# }
# payroll_translation = {
#     'BRUTTO': 'Gross Salary',
#     'Gehalt': 'Salary',
#     'Prämie (laufend)': 'Bonus (Ongoing)',
#     'Urlaubszuschuss Aliqu. 688': 'Vacation Allowance Proportional (§688)',
#     'Weihnachtsremuneration Al. 688': 'Christmas Bonus (§688)',
#     'Prämie SZ': 'Special Bonus',
#     '** BRUTTO **': 'Gross Salary (Emphasized)',
#     'SV LFD.': 'Social Security (Ongoing)',
#     '* BEM. SV LFD.': 'Assessment Basis for Social Security (Ongoing)',
#     '*** ALV-% LFD RÜCKVERR.': 'Unemployment Insurance % Ongoing Retro Adjustment',
#     'SV SZ': 'Social Security Special Payment',
#     '* BEM. SV SZ': 'Assessment Basis for Social Security Special Payment',
#     '*** ALV-% SZ RÜCKVERR.': 'Unemployment Insurance % Special Payment Retro Adjustment',
#     'LST LFD': 'Wage Tax (Ongoing)',
#     'LST §67/1-2': 'Wage Tax §67/1-2 (Special Tax Rule)',
#     '* ABZÜGE': 'Deductions',
#     'BRU': 'Gross (Abbreviation)',
#     'E-CARD GEBÜHR': 'E-Card Fee (Health Insurance Card)',
#     '* ABZÜGE DIV': 'Various Deductions',
#     '** AUSZAHLUNG **': 'Net Payment',
#     'BRUTTOSUMME': 'Total Gross Amount',
#     'Sachbezug': 'Benefit in Kind',
#     '* BRUTTO (210)': 'Gross Salary (Code 210)',
#     'BASIS J/6': 'Base for J/6 Calculation (Vacation Pay Related)',
#     'J/6 BER.': 'J/6 Calculated',
#     'J/6 ÜBERHANG': 'J/6 Surplus',
#     'SV J/6 ÜBERHANG': 'Social Security on J/6 Surplus',
#     'SZ 67/1,2 IN J/6': 'Special Payment §67/1,2 Included in J/6',
#     'FREIBETRAG': 'Tax Allowance',
#     'SV.§67/1,2(225)': 'Social Security §67/1,2 (Code 225)',
#     '* BEM §67/1,2': 'Assessment Basis §67/1,2',
#     'LST §67/1,2': 'Wage Tax §67/1,2',
#     'BEM. LST TAB.': 'Assessment Basis for Wage Tax Table',
#     '* LST PFL. (245)': 'Taxable Wage Tax (Code 245)',
#     'LST 67/1,2': 'Wage Tax §67/1,2',
#     '* ANR. LST (260)': 'Additional Wage Tax (Code 260)',
#     'SV-DG ANTEIL': 'Employer Social Security Share',
#     'BEM.MV-KASSE GESAMT': 'Assessment Basis for Pension Fund Total',
#     'MV-KASSE GESAMT': 'Pension Fund Total Amount',
#     'DB BEMESSUNG': 'Assessment Base for Severance Pay',
#     'DB BERECHNET (FB BERÜCK)': 'Severance Pay Calculated (Considering Deductions)',
#     'DZ BERECHNET (FB BERÜCK)': 'Supplementary Severance Pay Calculated',
#     'KOMM.ST.BEM.': 'Assessment Basis for Municipal Tax',
#     'KOMM.ST.BERECHNET (FB ERÜCK)': 'Municipal Tax Calculated (Considering Deductions)',
#     'U-BAHNSTEUER': 'Subway Tax (Local Tax in Vienna)',
#     'Homeoffice': 'Home Office',
#     'Tage Homeoffice': 'Home Office Days',
#     'Kostenübern. Par. 26 Z 5 lit b': 'Cost Coverage (Legal Paragraph 26 Z 5 lit b)',
#     'Kontroll6tel': 'Control Sixth (Specific Calculation Term)',
#     '§ 68/1 FREI': '§68/1 Exempt',
#     '§ 68/2 FREI': '§68/2 Exempt',
#     'SV-EINBEH. UE/KE': 'Social Security Deduction for UE/KE',
#     'SV-LFD. UE/KE': 'Social Security Ongoing for UE/KE',
#     'SV-SZ UE/KE': 'Social Security Special Payment for UE/KE',
#     'SV-Tage für UE/UA/EL f. Url.': 'Social Security Days for UE/UA/EL for Vacation',
#     'Abfertigung ges. (Auszahlung)': 'Severance Pay Total (Payout)',
#     'Steuerfr. § 26': 'Tax Exempt §26',
#     'Ersatzl. Urlaub 67/8d lfd.': 'Replacement Vacation §67/8d Ongoing',
#     'Ersatzl. Urlaub 67/8d SZ': 'Replacement Vacation §67/8d Special Payment',
#     'Üstd. 50 %  § (68/2)': 'Overtime 50% §68/2',
#     'Üstd. Zuschl. 100 % (§ 68/1)': 'Overtime Premium 100% (§68/1)',
#     'Üstd. Grundvergütung': 'Overtime Base Pay',
# }
payroll_translation = {
    "BRUTTO": "Gross Salary",
    "Gehalt": "Salary",
    "Prämie (laufend)": "Bonus (Ongoing)",
    "Urlaubszuschuss Aliqu. 688": "Vacation Allowance Proportional (§688)",
    "Weihnachtsremuneration Al. 688": "Christmas Bonus (§688)",
    "Prämie SZ": "Special Bonus",
    "** BRUTTO **": "Gross Salary (Emphasized)",
    "SV LFD.": "Social Security (Ongoing)",
    "* BEM. SV LFD.": "Assessment Basis for Social Security (Ongoing)",
    "*** ALV-% LFD RÜCKVERR.": "Unemployment Insurance % Ongoing Retro Adjustment",
    "*** ALV-% SZ RÜCKVERR.": "Unemployment Insurance % Special Payment Retro Adjustment",
    "SV SZ": "Social Security Special Payment",
    "* BEM. SV SZ": "Assessment Basis for Social Security Special Payment",
    "*** ALV-% SZ RÜCKVERR.": "Unemployment Insurance % Special Payment Retro Adjustment",
    "LST LFD": "Wage Tax (Ongoing)",
    "LST §67/1-2": "Wage Tax §67/1-2 (Special Tax Rule)",
    "* ABZÜGE": "Deductions",
    "BRU": "Gross (Abbreviation)",
    "E-CARD GEBÜHR": "E-Card Fee (Health Insurance Card)",
    "* ABZÜGE DIV": "Various Deductions",
    "** AUSZAHLUNG **": "Net Payment",
    "BRUTTOSUMME": "Total Gross Amount",
    "Sachbezug": "Benefit in Kind",
    "* BRUTTO (210)": "Gross Salary (Code 210)",
    "BASIS J/6": "Base for J/6 Calculation (Vacation Pay Related)",
    "J/6 BER.": "J/6 Calculated",
    "J/6 ÜBERHANG": "J/6 Surplus",
    "SV J/6 ÜBERHANG": "Social Security on J/6 Surplus",
    "SZ 67/1,2 IN J/6": "Special Payment §67/1,2 Included in J/6",
    "FREIBETRAG": "Tax Allowance",
    "SV.§67/1,2(225)": "Social Security §67/1,2 (Code 225)",
    "* BEM §67/1,2": "Assessment Basis §67/1,2",
    "LST §67/1,2": "Wage Tax §67/1,2",
    "BEM. LST TAB.": "Assessment Basis for Wage Tax Table",
    "* LST PFL. (245)": "Taxable Wage Tax (Code 245)",
    "LST 67/1,2": "Wage Tax §67/1,2",
    "* ANR. LST (260)": "Additional Wage Tax (Code 260)",
    "SV-DG ANTEIL": "Employer Social Security Share",
    "BEM.MV-KASSE GESAMT": "Assessment Basis for Pension Fund Total",
    "MV-KASSE GESAMT": "Pension Fund Total Amount",
    "DB BEMESSUNG": "Assessment Base for Severance Pay",
    "DB BERECHNET (FB BERÜCK)": "Severance Pay Calculated (Considering Deductions)",
    "DZ BERECHNET (FB BERÜCK)": "Supplementary Severance Pay Calculated",
    "KOMM.ST.BEM.": "Assessment Basis for Municipal Tax",
    "KOMM.ST.BERECHNET (FB ERÜCK)": "Municipal Tax Calculated (Considering Deductions)",
    "U-BAHNSTEUER": "Subway Tax (Local Tax in Vienna)",
    "Homeoffice": "Home Office",
    "Tage Homeoffice": "Home Office Days",
    "Kostenübern. Par. 26 Z 5 lit b": "Cost Coverage (Legal Paragraph 26 Z 5 lit b)",
    "Kontroll6tel": "Control Sixth (Specific Calculation Term)",
    "§ 68/1 FREI": "§68/1 Exempt",
    "§ 68/2 FREI": "§68/2 Exempt",
    "SV-EINBEH. UE/KE": "Social Security Deduction for UE/KE",
    "SV-LFD. UE/KE": "Social Security Ongoing for UE/KE",
    "SV-SZ UE/KE": "Social Security Special Payment for UE/KE",
    "SV-Tage für UE/UA/EL f. Url.": "Social Security Days for UE/UA/EL for Vacation",
    "Abfertigung ges. (Auszahlung)": "Severance Pay Total (Payout)",
    "Steuerfr. § 26": "Tax Exempt §26",
    "Ersatzl. Urlaub 67/8d lfd.": "Replacement Vacation §67/8d Ongoing",
    "Ersatzl. Urlaub 67/8d SZ": "Replacement Vacation §67/8d Special Payment",
    "Üstd. 50 %  § (68/2)": "Overtime 50% §68/2",
    "Üstd. Zuschl. 100 % (§ 68/1)": "Overtime Premium 100% (§68/1)",
    "Üstd. Grundvergütung": "Overtime Base Pay",
}

for val in df["Description"].unique():
    if "ALV" in val:
        print(repr(val))

if "Description" in df.columns:
    df["Description"] = df["Description"].str.strip()
    df["Description"] = df["Description"].map(payroll_translation).fillna(df["Description"])

# Save translated CSV
df.to_csv("time-series/payroll/Lohnkonto2022-2025_english.csv", index=False, encoding="utf-8")
